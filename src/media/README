README for packagemanagement/src/media

* What you find here

This directory contains all files for direct ('physical') installation
media access. Installation media is a 'installation data provider',
providing selections, packages, and patches.

Access is read-only since an installation media should not be
changed by yast.

!! MediaAccess handles physical access without checking media contents.
   The latter is handled and an upper layer (InstSrc) must verify correctness
   of the media.

All different kinds of media (i.e. cd, nfs, ftp, ...) are handled
transparently by a MediaAccess object.

* How to use it

Media access is handled by first openining (MediaAccess::open())
a media. A media is specified by an URL. See doc/MediaAccess.xml
for details.

After opening, a MediaAccess object must be attached to
(MediaAccess::attachTo()) a local directory. This can be seen
as mounting the media device to a mount point. All files from
the media are provided below this directory. In order to access
a file, it must be explicitly requested (MediaAccess::provideFile()).

When requesting a file, the filename is interpreted as a path
relative to the media 'root dir' as specified during MediaAccess::open().
The same directory structure is created below the 'mount point'.

Example:

After
  MediaAccess::open("cd:/dev/cdrom:/cdpath/cddir");
  MediaAccess::attachTo ("/local/cdpoint");
calling
  MediaAccess::provideFile ("suse/setup/descr/info");
will copy
  /cdpath/cddir/suse/setup/descr/info
from CD device /dev/cdrom to
  /local/cdpoint/suse/setup/descr/info
on the local system.

This file can then be handled by normal (C/C++) file i/o calls.

Some media types (i.e. ftp, http) do an actual transfer of the
file and create a local directory hierachy. This is sometimes useful
if the file data is to be re-used later without the cost for
transferring the file. If this is not wanted, MediaAccess::cleanUp()
should be called.

MediaAccess::release() 'unmounts' the media from the local directory
and is used when changing media on the same URL (i.e. multiple CD-ROMs
for installation).

MediaAccess:close() shuts down access.


* Further access functions

- searching for a file

If the filename is only partly known, MediaAccess::findFile() can be
used to find a matching filename.

- scanning through a directory

A list of files from a directory can be retrieved by calling
MediaAccess::dirInfo()

- getting file information

A 'stat' on a file without actually retrieving it can be done by
MediaAccess::fileInfo()

-----------------------------------------------------------

